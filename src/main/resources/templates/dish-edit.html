<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(~{::title}, ~{::content})}">

<head>
    <title>Редактирование рецепта</title>
</head>

<body>
<div th:fragment="content" class="container py-4">

    <h1 class="mb-4">Редактировать рецепт</h1>

    <!-- ОДНА форма -->
    <form th:action="@{/dishes/{id}/edit(id=${id})}"
          th:object="${form}"
          method="post">

        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div class="mb-3">
            <label class="form-label">Название</label>
            <input type="text" class="form-control" th:field="*{name}" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Категория</label>
            <input type="text" class="form-control" th:field="*{categoryName}">
        </div>

        <div class="mb-3">
            <label class="form-label">URL финального изображения</label>
            <input type="url" class="form-control" th:field="*{finalImageUrl}">
        </div>

        <div class="mb-3">
            <label class="form-label">URL изображения из мультфильма</label>
            <input type="url" class="form-control" th:field="*{cartoonImageUrl}">
        </div>

        <div class="mb-3">
            <label class="form-label">Шаги приготовления (по одному шагу на строку)</label>
            <textarea class="form-control" rows="8"
                      th:text="${form.stepDescriptions != null ? #strings.listJoin(form.stepDescriptions, '\n') : ''}"></textarea>

            <input type="hidden" name="stepDescriptions[0]"
                   th:value="${form.stepDescriptions != null ? #strings.listJoin(form.stepDescriptions, '\n') : ''}">
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">Сохранить</button>
            <a th:href="@{/dishes/{id}(id=${id})}" class="btn btn-outline-secondary">Отмена</a>
        </div>

    </form>
</div>
</body>
</html>
